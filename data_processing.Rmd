---
title: "Data Processing"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE}
#working directory
rm(list=ls())
setwd("~/Yale/2022 Fall/Tobin RA")
# packages
library(tidyverse)
library(readxl)
```
Reading in data:
```{r warning=FALSE}
# loading in data
df_2015 <- rbind(read_xlsx("data/2015.xlsx"), read_xlsx("data/2015b.xlsx"))
df_2016 <- read_xlsx("data/2016.xlsx")
df_2017 <- rbind(read_xlsx("data/2017.xlsx"), read_xlsx("data/2017b.xlsx"))
df_2018 <- rbind(read_xlsx("data/2018a.xlsx"),
                 read_xlsx("data/2018b.xlsx"),
                 read_xlsx("data/2018c.xlsx"))
df_2019 <- rbind(read_xlsx("data/2019a.xlsx"),
                 read_xlsx("data/2019b.xlsx"),
                 read_xlsx("data/2019c.xlsx"))
df_2020 <- read_xlsx("data/2020.xlsx")
```


```{r}
### getting consistent gender labels ###

# is there a more elegant way to do this???
df_2015$GENDER[!(df_2015$GENDER %in% c("Female", "Male", NA))] <- "Other"
df_2016$GENDER[!(df_2016$GENDER %in% c("Female", "Male", NA))] <- "Other"
df_2017$GENDER[!(df_2017$GENDER %in% c("Female", "Male", NA))] <- "Other"
df_2018$GENDER[!(df_2018$GENDER %in% c("Female", "Male", NA))] <- "Other"
df_2019$GENDER[!(df_2019$GENDER %in% c("Female", "Male", NA))] <- "Other"
df_2020$GENDER[!(df_2020$GENDER %in% c("Female", "Male", NA))] <- "Other"

### below doesn't work
# dfList <- list(df_2015, df_2016, df_2017, df_2018, df_2019, df_2020)
# lapply(dfList, function(x){
#   x$GENDER[!(x$GENDER %in% c("Female", "Male", NA))] <- "Other"
# })
# 
# table(df_2015$GENDER)

```

Writing a .RData file to streamline data loading in  data_analysis
```{r}
# saving data for easy loading next time
# use load() to load data
save(
  df_2015,
  df_2016,
  df_2017,
  df_2018,
  df_2019,
  df_2020,
  file="allyears.RData"
)
```



 
 